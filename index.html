<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sarangi Mart</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f7f7f7;
            margin: 0;
            padding: 0;
        }
        .header {
            background: #ff7e5f;
            color: white;
            text-align: center;
            padding: 20px;
        }
        .header img {
            height: 60px;
        }
        .container {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-around;
            padding: 20px;
        }
        .product-card {
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 15px;
            padding: 15px;
            width: 200px;
            text-align: center;
        }
        .product-card img {
            width: 100%;
            border-radius: 10px;
        }
        .cart {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            border-radius: 10px;
            padding: 15px;
            width: 250px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        .cart-item {
            margin-bottom: 10px;
        }
        button {
            background: #ff7e5f;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 8px 12px;
            cursor: pointer;
        }
        button:hover {
            background: #ff5c3a;
        }
        input[type=number] {
            width: 50px;
        }
    </style>
</head>
<body>

    <div class="header">
        <img src="logo.png" alt="Sarangi Mart Logo">
        <h1>SARANGI MART</h1>
        <p>Your Pre-Order Marketplace</p>
    </div>

    <!-- Products Section -->
    <div class="container">
        <div class="product-card">
            <img src="product1.jpg" alt="Notebook">
            <h3>Notebook</h3>
            <p>Price: ₹50</p>
            <p>Available: 20</p>
            <input type="number" id="qty1" min="1" value="1">
            <button onclick="addToCart('Notebook', 50, document.getElementById('qty1').value)">Add to Cart</button>
        </div>

        <div class="product-card">
            <img src="product2.jpg" alt="Pen">
            <h3>Pen</h3>
            <p>Price: ₹10</p>
            <p>Available: 100</p>
            <input type="number" id="qty2" min="1" value="1">
            <button onclick="addToCart('Pen', 10, document.getElementById('qty2').value)">Add to Cart</button>
        </div>

        <div class="product-card">
            <img src="product3.jpg" alt="Eraser">
            <h3>Eraser</h3>
            <p>Price: ₹5</p>
            <p>Available: 50</p>
            <input type="number" id="qty3" min="1" value="1">
            <button onclick="addToCart('Eraser', 5, document.getElementById('qty3').value)">Add to Cart</button>
        </div>
    </div>

    <!-- Cart Section -->
    <div class="cart">
        <h3>Cart</h3>
        <div id="cart-items"></div>
        <p id="total">Total: ₹0</p>
        <button onclick="placeOrder()">Place Order</button>
    </div>

    <!-- EmailJS SDK -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
    <!-- Initialize EmailJS -->
    <script>
        emailjs.init("NHtKUf_XQBBT-W7PY"); // Your User ID
    </script>
    <!-- Script.js Content -->
    <script>
        let cart = [];

        function addToCart(name, price, quantity) {
            quantity = parseInt(quantity);
            if(quantity <= 0) return alert("Enter valid quantity");

            let existing = cart.find(item => item.name === name);
            if(existing) {
                existing.quantity += quantity;
            } else {
                cart.push({name, price, quantity});
            }
            renderCart();
        }

        function renderCart() {
            const cartDiv = document.getElementById("cart-items");
            cartDiv.innerHTML = "";
            let total = 0;
            cart.forEach((item, index) => {
                total += item.price * item.quantity;
                const div = document.createElement("div");
                div.classList.add("cart-item");
                div.innerHTML = `${item.name} x ${item.quantity} = ₹${item.price*item.quantity} 
                <button onclick="removeItem(${index})">Remove</button>`;
                cartDiv.appendChild(div);
            });
            document.getElementById("total").innerText = `Total: ₹${total}`;
        }

        function removeItem(index) {
            cart.splice(index, 1);
            renderCart();
        }

        function placeOrder() {
            if(!navigator.onLine) return alert("No internet connection. Please connect and try again.");
            if(cart.length === 0) return alert("Cart is empty!");

            let orderDetails = "";
            cart.forEach(item => {
                orderDetails += `${item.name} x ${item.quantity} = ₹${item.price*item.quantity}\n`;
            });
            let total = cart.reduce((acc,item)=> acc + item.price*item.quantity,0);
            orderDetails += `Total: ₹${total}`;

            emailjs.send("service_glpy52q", "template_2gxdsn8", {
                user_name: "Deeptanshu",
                time: new Date().toLocaleString(),
                order_type: "Pre-orders only",
                message: orderDetails
            })
            .then(() => {
                alert("Order sent successfully!");
                cart = [];
                renderCart();
            })
            .catch(err => {
                alert("EmailJS Failed: " + JSON.stringify(err));
            });
        }
    </script>
</body>
</html>
